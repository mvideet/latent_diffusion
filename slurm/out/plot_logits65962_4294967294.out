Using device: cuda
Loading logits...
Loaded 128 logits tensors
Logits shape per step: torch.Size([1, 166, 126464])
Flattening tensors for CKA...
Feature shape: torch.Size([166, 126464])
Computing CKA similarities...
Processing CKA step 0/127
Processing CKA step 10/127
Processing CKA step 20/127
Processing CKA step 30/127
Processing CKA step 40/127
Processing CKA step 50/127
Processing CKA step 60/127
Processing CKA step 70/127
Processing CKA step 80/127
Processing CKA step 90/127
Processing CKA step 100/127
Processing CKA step 110/127
Processing CKA step 120/127
Computed 127 CKA scores
Computing KL divergences...
Processing KL step 0/127
Processing KL step 10/127
Processing KL step 20/127
Processing KL step 30/127
Processing KL step 40/127
Processing KL step 50/127
Processing KL step 60/127
Processing KL step 70/127
Processing KL step 80/127
Processing KL step 90/127
Processing KL step 100/127
Processing KL step 110/127
Processing KL step 120/127
Computed 127 KL divergence scores

==================================================
Running t-SNE analysis...
Running t-SNE analysis with 500 samples...
Processing step 0 for t-SNE...
Processing step 5 for t-SNE...
Processing step 10 for t-SNE...
Processing step 15 for t-SNE...
Processing step 20 for t-SNE...
Processing step 25 for t-SNE...
Processing step 30 for t-SNE...
Processing step 35 for t-SNE...
Processing step 40 for t-SNE...
Processing step 45 for t-SNE...
Processing step 50 for t-SNE...
Processing step 55 for t-SNE...
Processing step 60 for t-SNE...
Processing step 65 for t-SNE...
Processing step 70 for t-SNE...
Processing step 75 for t-SNE...
Processing step 80 for t-SNE...
Processing step 85 for t-SNE...
Processing step 90 for t-SNE...
Processing step 95 for t-SNE...
Processing step 100 for t-SNE...
Processing step 105 for t-SNE...
Processing step 110 for t-SNE...
Processing step 115 for t-SNE...
Processing step 120 for t-SNE...
Processing step 125 for t-SNE...
Running t-SNE on 4316 samples with 126464 dimensions...
[t-SNE] Computing 91 nearest neighbors...
[t-SNE] Indexed 4316 samples in 0.151s...
[t-SNE] Computed neighbors for 4316 samples in 17.704s...
[t-SNE] Computed conditional probabilities for sample 1000 / 4316
[t-SNE] Computed conditional probabilities for sample 2000 / 4316
[t-SNE] Computed conditional probabilities for sample 3000 / 4316
[t-SNE] Computed conditional probabilities for sample 4000 / 4316
[t-SNE] Computed conditional probabilities for sample 4316 / 4316
[t-SNE] Mean sigma: 0.000036
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.949100
[t-SNE] KL divergence after 1000 iterations: 0.419067
t-SNE analysis completed successfully!
Saved complete analysis as 'complete_diffusion_analysis.png'
Saved combined plot as 'diffusion_analysis.png'
Saved CKA plot as 'cka_similarity.png'
Saved KL plot as 'kl_divergence.png'
